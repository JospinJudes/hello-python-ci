{% extends "base.html" %}
{% block content %}

<h1 class="title gradient-text page-title">Home</h1>

<!-- NAVIGATION TABS -->
<div class="home-tabs">
    <a href="{{ url_for('main.home', sort='timeline') }}"
       class="navbar-button home-tab {% if sort=='timeline' %}active{% endif %}">
        Timeline
    </a>

    <a href="{{ url_for('main.home', sort='ranked') }}"
       class="navbar-button home-tab {% if sort=='ranked' %}active{% endif %}">
        Ranked
    </a>
</div>

<!-- LARGE SPACE BETWEEN BUTTONS AND CONTENT -->
<div class="home-separator"></div>

{% if tweets %}
<div class="tweets-container">

    {% for tweet in tweets %}
    <div class="tweet-card">

        <div class="tweet-header">
            <div class="tweet-user">@{{ tweet.user.name }}</div>
            <div class="tweet-date">{{ tweet.timestamp.strftime('%d/%m/%Y %H:%M') }}</div>
        </div>

        <div class="tweet-content">
            {{ tweet.content }}
        </div>

        <div class="tweet-actions">
            {% set liked = tweet.id in current_user.liked_tweet_ids %}
            <form action="{{ url_for('main.like_tweet', tweet_id=tweet.id) }}" method="POST">
                <button type="submit" class="like-btn {% if liked %}liked{% endif %}">
                    ❤️ Like ({{ tweet.likes_count }})
                </button>
            </form>
        </div>

        <form action="{{ url_for('main.comment_tweet', tweet_id=tweet.id) }}"
              method="POST" class="comment-form">
            <input type="text" name="comment_content" placeholder="Add a comment..." class="comment-input">
            <button type="submit" class="comment-btn">Comment</button>
        </form>

        {% if tweet.comments %}
        <ul class="comment-list">
            {% for comment in tweet.comments %}
            <li class="comment-item">
                <strong>{{ comment.user.name }}</strong> : {{ comment.content }}
            </li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>
    {% endfor %}

</div>

{% else %}
<p class="empty-message">No posts yet.</p>
{% endif %}

{% endblock %}
