{% extends "base.html" %}
{% block content %}

<div class="column is-4 is-offset-4">
  <div class="box has-text-centered"
       style="background: rgba(255, 255, 255, 0.6);
              border-radius: 28px;
              padding: 2.5rem;
              backdrop-filter: blur(12px);
              -webkit-backdrop-filter: blur(12px);
              box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
              border: 1px solid rgba(255, 255, 255, 0.4);">

    <h3 class="title gradient-text" style="font-size: 2.2rem; margin-bottom: 1.4rem;">
      Change Password
    </h3>

    <!-- âœ… Messages flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="notification {% if category == 'success' %}is-success{% else %}is-danger{% endif %}"
               style="border-radius: 18px;">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('auth.password_post') }}">
      <!-- Mot de passe actuel -->
      <div class="field" style="margin-bottom: 1.2rem;">
        <div class="control has-icons-left">
          <input class="input is-medium"
                 type="password"
                 name="current_password"
                 placeholder="Current password"
                 required
                 style="border-radius: 18px; padding: 1rem; font-size: 1rem;
                        background: rgba(255,255,255,0.9); color: #333; border: none;">
          <span class="icon is-small is-left">
            <i class="fas fa-lock" style="color: #666;"></i>
          </span>
        </div>
      </div>

      <!-- Nouveau mot de passe -->
      <div class="field" style="margin-bottom: 1.2rem;">
        <div class="control has-icons-left">
          <input class="input is-medium"
                 type="password"
                 name="new_password"
                 placeholder="New password"
                 required minlength="6"
                 pattern='^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*(),.?":{}|]).+$'
                 title="At least 6 characters, one uppercase, one digit, and one special character."
                 style="border-radius: 18px; padding: 1rem; font-size: 1rem;
                        background: rgba(255,255,255,0.9); color: #333; border: none;">
          <span class="icon is-small is-left">
            <i class="fas fa-key" style="color: #666;"></i>
          </span>
        </div>
      </div>

      <!-- Boutons -->
      <div class="buttons" style="margin-top: 1.2rem; display: flex; gap: .6rem;">
        <button class="button is-medium is-fullwidth"
                style="border-radius: 22px; padding: 1rem; font-size: 1.1rem;
                       background: linear-gradient(135deg, #ff416c, #ff4b2b, #ff6a00);
                       border: none; color: white; font-weight: bold;">
          Save
        </button>

        <a class="button is-medium is-fullwidth"
           href="{{ url_for('main.profile') }}"
           style="border-radius: 22px; padding: 1rem; font-size: 1.1rem;">
          Cancel
        </a>
      </div>
    </form>

  </div>
</div>

<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
{% endblock %}